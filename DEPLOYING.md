# Deploying Slacklinegroups to K8s
----

## Building Production Images

Before building a production image, determine what tag to use. Ideally, use a version tag one after the latest production build. Replace `vX` with your tag below when running the build command:

```
$ docker build -t syntaf/slacklinegroups:vX --build-arg RAILS_ENV=production --build-arg USER_ID=$(id -u) --build-arg GROUP_ID=1000 -f ./slacklinegroups/Dockerfile.production ./slacklinegroups
```

Then push your new tagged image:

```
$ docker push syntaf/slacklinegroups:vX
```

## Deploying to Kubernetes (Fresh)

Inside your cluster, run the following commands in order:

```
$ helm install k8s/slacklinegroups --generate-name
$ helm install nginx-stable/nginx-ingress --generate-name
$ kubectl apply -f k8s/ingress
```

At the moment, you will need to manually swap out the release name inside the ingress file with the one generated by the first command.

## Upgrading the K8 Stack